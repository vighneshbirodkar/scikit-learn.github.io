
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
  
    <title>1.17. Neural network models (supervised) &mdash; scikit-learn 0.18.dev0 documentation</title>
  <!-- htmltitle is before nature.css - we use this hack to load bootstrap first -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../_static/css/bootstrap.min.css" media="screen" />
  <link rel="stylesheet" href="../_static/css/bootstrap-responsive.css"/>

    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.18.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="scikit-learn 0.18.dev0 documentation" href="../index.html" />
    <link rel="up" title="1. Supervised learning" href="../supervised_learning.html" />
    <link rel="next" title="2. Unsupervised learning" href="../unsupervised_learning.html" />
    <link rel="prev" title="1.16. Probability calibration" href="calibration.html" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="../_static/js/bootstrap.min.js" type="text/javascript"></script>
  <link rel="canonical" href="http://scikit-learn.org/stable/modules/neural_networks_supervised.html" />

  <script type="text/javascript">
    $("div.buttonNext, div.buttonPrevious").hover(
       function () {
           $(this).css('background-color', '#FF9C34');
       },
       function () {
           $(this).css('background-color', '#A7D6E2');
       }
    );
  </script>

  </head>
  <body>

<div class="header-wrapper">
    <div class="header">
        <p class="logo"><a href="../index.html">
            <img src="../_static/scikit-learn-logo-small.png" alt="Logo"/>
        </a>
        </p><div class="navbar">
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="../install.html">Installation</a></li>
                <li class="btn-li"><div class="btn-group">
              <a href="../documentation.html">Documentation</a>
              <a class="btn dropdown-toggle" data-toggle="dropdown">
                 <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
            <li class="link-title">Scikit-learn 0.17 (development)</li>
            <li><a href="../tutorial/index.html">Tutorials</a></li>
            <li><a href="../user_guide.html">User guide</a></li>
            <li><a href="classes.html">API</a></li>
            <li><a href="../faq.html">FAQ</a></li>
            <li><a href="../developers.html">Contributing</a></li>
            <li class="divider"></li>
                <li><a href="http://scikit-learn.org/stable/documentation.html">Scikit-learn 0.16.1 (stable)</a></li>
                <li><a href="http://scikit-learn.org/0.15/documentation.html">Scikit-learn 0.15</a></li>
				<li><a href="../_downloads/user_guide.pdf">PDF documentation</a></li>
              </ul>
            </div>
        </li>
            <li><a href="../auto_examples/index.html">Examples</a></li>
            </ul>

            <div class="search_form">
                <div id="cse" style="width: 100%;"></div>
            </div>
        </div> <!-- end navbar --></div>
</div>


<!-- Github "fork me" ribbon -->
<a href="https://github.com/scikit-learn/scikit-learn">
  <img class="fork-me"
       style="position: absolute; top: 0; right: 0; border: 0;"
       src="../_static/img/forkme.png"
       alt="Fork me on GitHub" />
</a>

<div class="content-wrapper">
    <div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
        <div class="rel">
    

  <!-- rellinks[1:] is an ugly hack to avoid link to module
  index -->
        <div class="rellink">
        <a href="calibration.html"
        accesskey="P">Previous
        <br/>
        <span class="smallrellink">
        1.16. Probabi...
        </span>
            <span class="hiddenrellink">
            1.16. Probability calibration
            </span>
        </a>
        </div>

    <!-- Ad a link to the 'up' page -->
        <div class="spacer">
        &nbsp;
        </div>
        <div class="rellink">
        <a href="../supervised_learning.html">
        Up
        <br/>
        <span class="smallrellink">
        1. Supervised...
        </span>
            <span class="hiddenrellink">
            1. Supervised learning
            </span>
            
        </a>
        </div>
    </div>
    
      <p class="doc-version">This documentation is for scikit-learn <strong>version 0.18.dev0</strong> &mdash; <a href="http://scikit-learn.org/stable/support.html#documentation-resources">Other versions</a></p>
    <p class="citing">If you use the software, please consider <a href="../about.html#citing-scikit-learn">citing scikit-learn</a>.</p>
    <ul>
<li><a class="reference internal" href="#">1.17. Neural network models (supervised)</a><ul>
<li><a class="reference internal" href="#multi-layer-perceptron">1.17.1. Multi-layer Perceptron</a></li>
<li><a class="reference internal" href="#classification">1.17.2. Classification</a></li>
<li><a class="reference internal" href="#regression">1.17.3. Regression</a></li>
<li><a class="reference internal" href="#algorithms">1.17.4. Algorithms</a></li>
<li><a class="reference internal" href="#complexity">1.17.5. Complexity</a></li>
<li><a class="reference internal" href="#mathematical-formulation">1.17.6. Mathematical formulation</a></li>
<li><a class="reference internal" href="#tips-on-practical-use">1.17.7. Tips on Practical Use</a></li>
<li><a class="reference internal" href="#more-control-with-warm-start">1.17.8. More control with warm_start</a></li>
</ul>
</li>
</ul>

    </div>
</div>

<input type="checkbox" id="nav-trigger" class="nav-trigger" checked />
<label for="nav-trigger"></label>




      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="neural-network-models-supervised">
<span id="neural-network"></span><h1>1.17. Neural network models (supervised)<a class="headerlink" href="#neural-network-models-supervised" title="Permalink to this headline">¶</a></h1>
<div class="section" id="multi-layer-perceptron">
<span id="multilayer-perceptron"></span><h2>1.17.1. Multi-layer Perceptron<a class="headerlink" href="#multi-layer-perceptron" title="Permalink to this headline">¶</a></h2>
<p><strong>Multi-layer Perceptron (MLP)</strong> is a supervised learning algorithm that learns
a function <img class="math" src="../_images/math/3f8133190ff7864190e0430e0ab579493351ed87.png" alt="f(\cdot): R^m \rightarrow R^o"/> by training on a dataset,
where <img class="math" src="../_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> is the number of dimensions for input and <img class="math" src="../_images/math/12ea3a10030ba2d90f89dab440196780a4b19e93.png" alt="o"/> is the the
number of dimensions for output. Given a set of features <img class="math" src="../_images/math/433e45571c69f8fb8fbb9375f2047d581c279090.png" alt="X = {x_1, x_2, ..., x_m}"/>
and a target <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/>, it can learn a non-linear function approximator for either
classification or regression. It is different from logistic regression, in that
between the input and the output layer, there can be one or more non-linear
layers, called hidden layers. Figure 1 shows a one hidden layer MLP with scalar
output.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/multilayerperceptron_network.png"><img alt="../_images/multilayerperceptron_network.png" src="../_images/multilayerperceptron_network.png" style="width: 469.8px; height: 510.6px;" /></a>
<p class="caption"><strong>Figure 1 : One hidden layer MLP.</strong></p>
</div>
<p>The leftmost layer, known as the input layer, consists of a set of neurons
<img class="math" src="../_images/math/e6c53e63533be27092d0b8601741d2b27946b7eb.png" alt="\{x_i | x_1, x_2, ..., x_m\}"/> representing the input features. Each
neuron in the hidden layer transforms the values from the previous layer with
a weighted linear summation <img class="math" src="../_images/math/d07e73e12ef3ff7588a69ab03e0d78b3e784afd5.png" alt="w_1x_1 + w_2x_2 + ... + w_mx_m"/>, followed
by a non-linear activation function <img class="math" src="../_images/math/6bc6300a7acfc8f5432d100870e634966c51c0d1.png" alt="g(\cdot):R \rightarrow R"/> - like
the hyperbolic tan function. The output layer receives the values from the
last hidden layer and transforms them into output values.</p>
<p>The module contains the public attributes <tt class="docutils literal"><span class="pre">coefs_</span></tt> and <tt class="docutils literal"><span class="pre">intercepts_</span></tt>.
<tt class="docutils literal"><span class="pre">coefs_</span></tt> is a list of weight matrices, where weight matrix at index
<img class="math" src="../_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> represents the weights between layer <img class="math" src="../_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> and layer
<img class="math" src="../_images/math/cabaea4f4c8ba6d97bfb3055f1a0f3bc14d55e9b.png" alt="i+1"/>. <tt class="docutils literal"><span class="pre">intercepts_</span></tt> is a list of bias vectors, where the vector
at index <img class="math" src="../_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> represents the bias values added to layer <img class="math" src="../_images/math/cabaea4f4c8ba6d97bfb3055f1a0f3bc14d55e9b.png" alt="i+1"/>.</p>
<p>The advantages of Multi-layer Perceptron are:</p>
<blockquote>
<div><ul class="simple">
<li>Capability to learn non-linear models.</li>
<li>Capability to learn models in real-time (on-line learning)
using <tt class="docutils literal"><span class="pre">partial_fit</span></tt>.</li>
</ul>
</div></blockquote>
<p>The disadvantages of Multi-layer Perceptron (MLP) include:</p>
<blockquote>
<div><ul class="simple">
<li>MLP with hidden layers have a non-convex loss function where there exists
more than one local minimum. Therefore different random weight
initializations can lead to different validation accuracy.</li>
<li>MLP requires tuning a number of hyperparameters such as the number of
hidden neurons, layers, and iterations.</li>
<li>MLP is sensitive to feature scaling.</li>
</ul>
</div></blockquote>
<p>Please see <a class="reference internal" href="#mlp-tips"><em>Tips on Practical Use</em></a> section that addresses
some of these disadvantages.</p>
</div>
<div class="section" id="classification">
<h2>1.17.2. Classification<a class="headerlink" href="#classification" title="Permalink to this headline">¶</a></h2>
<p>Class <a class="reference internal" href="generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier" title="sklearn.neural_network.MLPClassifier"><tt class="xref py py-class docutils literal"><span class="pre">MLPClassifier</span></tt></a> implements a multi-layer perceptron (MLP) algorithm
that trains using <a class="reference external" href="http://ufldl.stanford.edu/wiki/index.php/Backpropagation_Algorithm">Backpropagation</a>.</p>
<p>MLP trains on two arrays: array X of size (n_samples, n_features), which holds
the training samples represented as floating point feature vectors; and array
y of size (n_samples,), which holds the target values (class labels) for the
training samples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;l-bfgs&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> 
<span class="go">MLPClassifier(activation=&#39;relu&#39;, algorithm=&#39;l-bfgs&#39;, alpha=1e-05,</span>
<span class="go">       batch_size=200, beta_1=0.9, beta_2=0.999, early_stopping=False,</span>
<span class="go">       epsilon=1e-08, hidden_layer_sizes=(5, 2), learning_rate=&#39;constant&#39;,</span>
<span class="go">       learning_rate_init=0.001, max_iter=200, momentum=0.9,</span>
<span class="go">       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,</span>
<span class="go">       tol=0.0001, validation_fraction=0.1, verbose=False,</span>
<span class="go">       warm_start=False)</span>
</pre></div>
</div>
<p>After fitting (training), the model can predict labels for new samples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="p">]])</span>
<span class="go">array([1, 0])</span>
</pre></div>
</div>
<p>MLP can fit a non-linear model to the training data. <tt class="docutils literal"><span class="pre">clf.coefs_</span></tt>
contains the weight matrices that constitute the model parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">coef</span><span class="o">.</span><span class="n">shape</span> <span class="k">for</span> <span class="n">coef</span> <span class="ow">in</span> <span class="n">clf</span><span class="o">.</span><span class="n">coefs_</span><span class="p">]</span>
<span class="go">[(2, 5), (5, 2), (2, 1)]</span>
</pre></div>
</div>
<p>To get the raw values before applying the output activation function, run the
following command,</p>
<p>use <a class="reference internal" href="generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier.decision_function" title="sklearn.neural_network.MLPClassifier.decision_function"><tt class="xref py py-meth docutils literal"><span class="pre">MLPClassifier.decision_function</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">decision_function</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]])</span>  
<span class="go">array([ 47.6...,  47.6...])</span>
</pre></div>
</div>
<p>Currently, <a class="reference internal" href="generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier" title="sklearn.neural_network.MLPClassifier"><tt class="xref py py-class docutils literal"><span class="pre">MLPClassifier</span></tt></a> supports only the
Cross-Entropy loss function, which allows probability estimates by running the
<tt class="docutils literal"><span class="pre">predict_proba</span></tt> method.</p>
<p>MLP trains using Backpropagation. More precisely, it trains using some form of
gradient descent and the gradients are calculated using Backpropagation. For
classification, it minimizes the Cross-Entropy loss function, giving a vector
of probability estimates <img class="math" src="../_images/math/25a9728b809a691ce3374eaeab6255410cbff5d9.png" alt="P(y|x)"/> per sample <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]])</span>  
<span class="go">array([[ 0.,  1.],</span>
<span class="go">       [ 0.,  1.]])</span>
</pre></div>
</div>
<p><a class="reference internal" href="generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier" title="sklearn.neural_network.MLPClassifier"><tt class="xref py py-class docutils literal"><span class="pre">MLPClassifier</span></tt></a> supports multi-class classification by
applying <a class="reference external" href="http://en.wikipedia.org/wiki/Softmax_activation_function">Softmax</a>
as the output function.</p>
<p>Further, the algorithm supports <a class="reference internal" href="multiclass.html#multiclass"><em>multi-label classification</em></a>
in which a sample can belong to more than one class. For each class, the output
of <a class="reference internal" href="generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier.decision_function" title="sklearn.neural_network.MLPClassifier.decision_function"><tt class="xref py py-meth docutils literal"><span class="pre">MLPClassifier.decision_function</span></tt></a> passes through the
logistic function. Values larger or equal to <cite>0.5</cite> are rounded to <cite>1</cite>,
otherwise to <cite>0</cite>. For a predicted output of a sample, the indices where the
value is <cite>1</cite> represents the assigned classes of that sample:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s">&#39;l-bfgs&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">MLPClassifier(activation=&#39;relu&#39;, algorithm=&#39;l-bfgs&#39;, alpha=1e-05,</span>
<span class="go">       batch_size=200, beta_1=0.9, beta_2=0.999, early_stopping=False,</span>
<span class="go">       epsilon=1e-08, hidden_layer_sizes=(15,), learning_rate=&#39;constant&#39;,</span>
<span class="go">       learning_rate_init=0.001, max_iter=200, momentum=0.9,</span>
<span class="go">       nesterovs_momentum=True, power_t=0.5, random_state=1, shuffle=True,</span>
<span class="go">       tol=0.0001, validation_fraction=0.1, verbose=False,</span>
<span class="go">       warm_start=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">])</span>
<span class="go">array([[1, 1]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="go">array([[0, 1]])</span>
</pre></div>
</div>
<p>See the examples below and the doc string of
<a class="reference internal" href="generated/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier.fit" title="sklearn.neural_network.MLPClassifier.fit"><tt class="xref py py-meth docutils literal"><span class="pre">MLPClassifier.fit</span></tt></a> for further information.</p>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li><em class="xref std std-ref">example_plot_mlp_alpha.py</em></li>
</ul>
</div>
</div>
<div class="section" id="regression">
<h2>1.17.3. Regression<a class="headerlink" href="#regression" title="Permalink to this headline">¶</a></h2>
<p>Class <a class="reference internal" href="generated/sklearn.neural_network.MLPRegressor.html#sklearn.neural_network.MLPRegressor" title="sklearn.neural_network.MLPRegressor"><tt class="xref py py-class docutils literal"><span class="pre">MLPRegressor</span></tt></a> implements a multi-layer perceptron (MLP) that
trains using backpropagation with no activation function in the output layer,
which can also be seen as using the identity function as activation function.
Therefore, it uses the square error as the loss function, and the output is a
set of continuous values.</p>
<p><a class="reference internal" href="generated/sklearn.neural_network.MLPRegressor.html#sklearn.neural_network.MLPRegressor" title="sklearn.neural_network.MLPRegressor"><tt class="xref py py-class docutils literal"><span class="pre">MLPRegressor</span></tt></a> also supports multi-output regression, in
which a sample can have more than one target.</p>
</div>
<div class="section" id="algorithms">
<h2>1.17.4. Algorithms<a class="headerlink" href="#algorithms" title="Permalink to this headline">¶</a></h2>
<p>MLP trains using <a class="reference external" href="http://en.wikipedia.org/wiki/Stochastic_gradient_descent">Stochastic Gradient Descent</a>,
<a class="reference external" href="http://arxiv.org/abs/1412.6980">Adam</a>, or
<a class="reference external" href="http://en.wikipedia.org/wiki/Limited-memory_BFGS">L-BFGS</a>.
Stochastic Gradient Descent (SGD) updates parameters using the gradient of the
loss function with respect to a parameter that needs adaptation, i.e.</p>
<div class="math">
<p><img src="../_images/math/2dbac3d4a21ff260f77a24c69c1e3b57acafcf2d.png" alt="w \leftarrow w - \eta (\alpha \frac{\partial R(w)}{\partial w}
+ \frac{\partial Loss}{\partial w})"/></p>
</div><p>where <img class="math" src="../_images/math/9172efc523d7488d4c3ed299d0be813de01503b8.png" alt="\eta"/> is the learning rate which controls the step-size in
the parameter space search.  <img class="math" src="../_images/math/80a949d749900fdcdb8e79f4a29bb0f75efb510b.png" alt="Loss"/> is the loss function used
for the network.</p>
<p>More details can be found in the documentation of
<a class="reference external" href="http://scikit-learn.org/stable/modules/sgd.html">SGD</a></p>
<p>Adam is similar to SGD in a sense that it is a stochastic optimization
algorithm, but it can automatically adjust the amount to update parameters
based on adaptive estimates of lower-order moments.</p>
<p>With SGD or Adam, training supports online and mini-batch learning.</p>
<p>L-BFGS is a fast learning algorithm that approximates the Hessian matrix which
represents the second-order partial derivative of a function. Further it
approximates the inverse of the Hessian matrix to perform parameter updates.
The implementation uses the Scipy version of
<a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin_l_bfgs_b.html">L-BFGS</a>..</p>
<p>If the selected algorithm is &#8216;L-BFGS&#8217;, training does not support online nor
mini-batch learning.</p>
</div>
<div class="section" id="complexity">
<h2>1.17.5. Complexity<a class="headerlink" href="#complexity" title="Permalink to this headline">¶</a></h2>
<p>Suppose there are <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> training samples, <img class="math" src="../_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> features, <img class="math" src="../_images/math/e9203da50e1059455123460d4e716c9c7f440cc3.png" alt="k"/>
hidden layers, each containing <img class="math" src="../_images/math/cbb80ad77aa7a5e227d5a46bc44d235284106cfc.png" alt="h"/> neurons - for simplicity, and <img class="math" src="../_images/math/12ea3a10030ba2d90f89dab440196780a4b19e93.png" alt="o"/>
output neurons.  The time complexity of backpropagation is
<img class="math" src="../_images/math/51cbbb194ebe308898727dceee8936b6fbb62f18.png" alt="O(n\cdot m \cdot h^k \cdot o \cdot i)"/>, where <img class="math" src="../_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> is the number
of iterations. Since backpropagation has a high time complexity, it is advisable
to start with smaller number of hidden neurons and few hidden layers for
training.</p>
</div>
<div class="section" id="mathematical-formulation">
<h2>1.17.6. Mathematical formulation<a class="headerlink" href="#mathematical-formulation" title="Permalink to this headline">¶</a></h2>
<p>Given a set of training examples <img class="math" src="../_images/math/b5b3d40937d9e36635a16e7a3b18f06458712ee9.png" alt="(x_1, y_1), (x_2, y_2), \ldots, (x_n, y_n)"/>
where <img class="math" src="../_images/math/ed7238746ec0fb27be38187ff0576c83ecc0df8f.png" alt="x_i \in \mathbf{R}^n"/> and <img class="math" src="../_images/math/1a6dcb0f90f8ed7f0f0b3af16613143be0ffd6c1.png" alt="y_i \in \{0, 1\}"/>, a one hidden
layer one hidden neuron MLP learns the function <img class="math" src="../_images/math/a050ea48ee8a8483ecae6199dcdb2448f02b5e17.png" alt="f(x) = W_2 g(W_1^T x + b_1) + b_2"/>
where <img class="math" src="../_images/math/8952714985c2bf822cadd25c899ee5f5f99c9364.png" alt="W_1 \in \mathbf{R}^m"/> and <img class="math" src="../_images/math/7b87d416cfdb18ebba1e07d8ee177f6d4778588b.png" alt="W_2, b_1, b_2 \in \mathbf{R}"/> are
model parameters. <img class="math" src="../_images/math/a8ca8de37487157e0ad9134f7b7cc0937f2f84ab.png" alt="W_1, W_2"/> represent the weights of the input layer and
hidden layer, resepctively; and <img class="math" src="../_images/math/3ee28c31216a8bcd9e06159b87cabf712e85d95d.png" alt="b_1, b_2"/> represent the bias added to
the hidden layer and the output layer, respectively.
<img class="math" src="../_images/math/1ebc52bf597809058fd5fe33cbcb3830fce77abd.png" alt="g(\cdot) : R \rightarrow R"/> is the activation function, set by default as
the hyperbolic tan. It is given as,</p>
<div class="math">
<p><img src="../_images/math/d3d8e7f87a429b546200aee5db4b1eaa631e6d3f.png" alt="g(z)= \frac{e^z-e^{-z}}{e^z+e^{-z}}"/></p>
</div><p>For binary classification, <img class="math" src="../_images/math/14546c27a7b929642f7840acca5f851c503ea109.png" alt="f(x)"/> passes through the logistic function
<img class="math" src="../_images/math/db2699a0f2aed4f24f5c6e5da9d2476c02a419a8.png" alt="g(z)=1/(1+e^{-z})"/> to obtain output values between zero and one. A
threshold, set to 0.5, would assign samples of outputs larger or equal 0.5
to the positive class, and the rest to the negative class.</p>
<p>If there are more than two classes, <img class="math" src="../_images/math/14546c27a7b929642f7840acca5f851c503ea109.png" alt="f(x)"/> itself would be a vector of
size (n_classes,). Instead of passing through logistic function, it passes
through the softmax function, which is written as,</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">\text{Softmax(z)_i} = \frac{\exp(z_i)}{\sum_{l=1}^k\exp(z_l)}

</tt>)</p>
latex exited with error
[stdout]
This is pdfTeX, Version 3.1415926-1.40.10 (TeX Live 2009/Debian)
entering extended mode
(./math.tex
LaTeX2e &lt;2009/09/24&gt;
Babel &lt;v3.8l&gt; and hyphenation patterns for english, usenglishmax, dumylang, noh
yphenation, loaded.
(/usr/share/texmf-texlive/tex/latex/base/article.cls
Document Class: article 2007/10/19 v1.4h Standard LaTeX document class
(/usr/share/texmf-texlive/tex/latex/base/size12.clo))
(/usr/share/texmf-texlive/tex/latex/base/inputenc.sty
(/usr/share/texmf-texlive/tex/latex/ucs/utf8x.def))
(/usr/share/texmf-texlive/tex/latex/ucs/ucs.sty
(/usr/share/texmf-texlive/tex/latex/ucs/data/uni-global.def))
(/usr/share/texmf-texlive/tex/latex/amsmath/amsmath.sty
For additional information on amsmath, use the `?&#8217; option.
(/usr/share/texmf-texlive/tex/latex/amsmath/amstext.sty
(/usr/share/texmf-texlive/tex/latex/amsmath/amsgen.sty))
(/usr/share/texmf-texlive/tex/latex/amsmath/amsbsy.sty)
(/usr/share/texmf-texlive/tex/latex/amsmath/amsopn.sty))
(/usr/share/texmf-texlive/tex/latex/amscls/amsthm.sty)
(/usr/share/texmf-texlive/tex/latex/amsfonts/amssymb.sty
(/usr/share/texmf-texlive/tex/latex/amsfonts/amsfonts.sty))
(/usr/share/texmf-texlive/tex/latex/tools/bm.sty) (./math.aux)
(/usr/share/texmf-texlive/tex/latex/ucs/ucsencs.def)
(/usr/share/texmf-texlive/tex/latex/amsfonts/umsa.fd)
(/usr/share/texmf-texlive/tex/latex/amsfonts/umsb.fd)
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\textdef&#64; ...th {#1}\let \f&#64;size #2\selectfont #3}
                                                  }
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\textdef&#64; ...h {#1}\let \f&#64;size #2\selectfont #3}}
                                                  
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\text&#64; ...e {\textdef&#64; \displaystyle \f&#64;size {#1}}
                                                  {\textdef&#64; \textstyle \f&#64;s...
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\textdef&#64; ...th {#1}\let \f&#64;size #2\selectfont #3}
                                                  }
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\textdef&#64; ...h {#1}\let \f&#64;size #2\selectfont #3}}
                                                  
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\text&#64; ...xtstyle \f&#64;size {\firstchoice&#64;false #1}}
                                                  {\textdef&#64; \textstyle \sf&#64;...
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\textdef&#64; ...th {#1}\let \f&#64;size #2\selectfont #3}
                                                  }
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\textdef&#64; ...h {#1}\let \f&#64;size #2\selectfont #3}}
                                                  
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\text&#64; ...tstyle \sf&#64;size {\firstchoice&#64;false #1}}
                                                  {\textdef&#64; \textstyle \ssf...
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\textdef&#64; ...th {#1}\let \f&#64;size #2\selectfont #3}
                                                  }
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\textdef&#64; ...h {#1}\let \f&#64;size #2\selectfont #3}}
                                                  
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\text&#64; ...style \ssf&#64;size {\firstchoice&#64;false #1}}
                                                  \check&#64;mathfonts }
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\text&#64; ...firstchoice&#64;false #1}}\check&#64;mathfonts }
                                                  
l.14 \end{gather}
                 
! Misplaced \crcr.
\endsplit -&gt;\crcr 
                  \egroup \egroup \iftagsleft&#64; \&#64;xp \lendsplit&#64; \else \&#64;xp \...
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\endsplit -&gt;\crcr \egroup 
                          \egroup \iftagsleft&#64; \&#64;xp \lendsplit&#64; \else \&#64;xp \...
l.14 \end{gather}
                 
! Extra }, or forgotten $.
\endsplit -&gt;\crcr \egroup \egroup 
                                  \iftagsleft&#64; \&#64;xp \lendsplit&#64; \else \&#64;xp \...
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing { inserted.
&lt;to be read again&gt; 
                   \endgroup 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing { inserted.
&lt;to be read again&gt; 
                   \endgroup 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing { inserted.
&lt;to be read again&gt; 
                   \endgroup 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing $ inserted.
&lt;inserted text&gt; 
                $
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
! Missing \cr inserted.
&lt;inserted text&gt; 
                \cr 
l.14 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.14 \end{gather}
                 
(That makes 100 errors; please try again.)
No pages of output.
Transcript written on math.log.
</div>
<p>where <img class="math" src="../_images/math/0c9b8c78a7a049eca8f2168d0691afc6a65a9dad.png" alt="z_i"/> represents the <img class="math" src="../_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> th element of the input to softmax,
which corresponds to class <img class="math" src="../_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/>, and <img class="math" src="../_images/math/28e003020d0ae96250b302d7d779c791f183f707.png" alt="K"/> is the number of classes.
The result is a vector containing the probabilities that sample <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>
belong to each class. The output is the class with the highest probability.</p>
<p>In regression, the output remains as <img class="math" src="../_images/math/14546c27a7b929642f7840acca5f851c503ea109.png" alt="f(x)"/>; therefore, output activation
function is just the identity function.</p>
<p>MLP uses different loss functions depending on the problem type. The loss
function for classification is Cross-Entropy, which in binary case is given as,</p>
<div class="math">
<p><img src="../_images/math/ab5970442c1dcd70ca590a06685d0fca5319f924.png" alt="Loss(\hat{y},y,W) = -y \ln {\hat{y}} - (1-y) \ln{(1-\hat{y})} + \alpha ||W||_2^2"/></p>
</div><p>where <img class="math" src="../_images/math/918f125a813a61c086e578cdaa33c7a8ee6e22a3.png" alt="\alpha ||W||_2^2"/> is an L2-regularization term (aka penalty)
that penalizes complex models; and <img class="math" src="../_images/math/7f2c98bf462cba6083cf18483ba9510e3c2fd3d3.png" alt="\alpha &gt; 0"/> is a non-negative
hyperparameter that controls the magnitude of the penalty.</p>
<p>For regression, MLP uses the Square Error loss function; written as,</p>
<div class="math">
<p><img src="../_images/math/372cb770e60e27b0c5f465e51565f1a74b25ba4f.png" alt="Loss(\hat{y},y,W) = \frac{1}{2}||\hat{y} - y ||_2^2 + \alpha ||W||_2^2"/></p>
</div><p>Starting from initial random weights, multi-layer perceptron (MLP) minimizes
the loss function by repeatedly updating these weights. After computing the
loss, a backward pass propagates it from the output layer to the previous
layers, providing each weight parameter with an update value meant to decrease
the loss.</p>
<p>In gradient descent, the gradient <img class="math" src="../_images/math/9eebd94123c7bbb990289db6e85bdbe64f72f1a0.png" alt="\nabla Loss_{W}"/> of the loss with respect
to the weights is computed and deducted from <img class="math" src="../_images/math/fa34489cf430b7630b30f28b2eb050e2489e3523.png" alt="W"/>.
More formally, this is expressed as,</p>
<div class="math">
<p><img src="../_images/math/90bf052193ba22f630c293f7082230be9dea19f6.png" alt="W^{i+1} = W^i - \epsilon \nabla {Loss}_{W}^{i}"/></p>
</div><p>where <img class="math" src="../_images/math/a581f053bbfa5115f42c13094857cdd12a37ec49.png" alt="i"/> is the iteration step, and <img class="math" src="../_images/math/19bc0073dde1bcd1a8e6a32b251e80cced668f04.png" alt="\epsilon"/> is the learning rate
with a value larger than 0.</p>
<p>The algorithm stops when it reaches a preset maximum number of iterations; or
when the improvement in loss is below a certain, small number.</p>
</div>
<div class="section" id="tips-on-practical-use">
<span id="mlp-tips"></span><h2>1.17.7. Tips on Practical Use<a class="headerlink" href="#tips-on-practical-use" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul>
<li><p class="first">Multi-layer Perceptron is sensitive to feature scaling, so it
is highly recommended to scale your data. For example, scale each
attribute on the input vector X to [0, 1] or [-1, +1], or standardize
it to have mean 0 and variance 1. Note that you must apply the <em>same</em>
scaling to the test set for meaningful results.
You can use <tt class="xref py py-class docutils literal"><span class="pre">StandardScaler</span></tt> for standardization.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="c"># Don&#39;t cheat - fit only on training data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="c"># apply same transformation to test data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  
</pre></div>
</div>
<p>An alternative and recommended approach is to use <tt class="xref py py-class docutils literal"><span class="pre">StandardScaler</span></tt>
in a <tt class="xref py py-class docutils literal"><span class="pre">Pipeline</span></tt></p>
</li>
<li><p class="first">Finding a reasonable regularization parameter <img class="math" src="../_images/math/ad59b6e24a4a00ac621801f8d7513d68be654ab5.png" alt="\alpha"/> is
best done using <tt class="xref py py-class docutils literal"><span class="pre">GridSearchCV</span></tt>, usually in the
range <tt class="docutils literal"><span class="pre">10.0</span> <span class="pre">**</span> <span class="pre">-np.arange(1,</span> <span class="pre">7)</span></tt>.</p>
</li>
<li><p class="first">Empirically, we observed that <cite>L-BFGS</cite> converges faster and
with better solutions on small datasets. For relatively large
datasets, however, <cite>Adam</cite> is very robust. It usually converges
quickly and gives pretty good performance. <cite>SGD</cite> with momentum or
nesterov&#8217;s momentum, on the other hand, can perform better than
those two algorithms if learning rate is correctly tuned.</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="more-control-with-warm-start">
<h2>1.17.8. More control with warm_start<a class="headerlink" href="#more-control-with-warm-start" title="Permalink to this headline">¶</a></h2>
<p>If you want more control over stopping criteria or learning rate in SGD,
or want to do additional monitoring, using <tt class="docutils literal"><span class="pre">warm_start=True</span></tt> and
<tt class="docutils literal"><span class="pre">max_iter=1</span></tt> and iterating yourself can be helpful:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">... </span>    <span class="c"># additional monitoring / inspection </span>
<span class="go">MLPClassifier(...</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">References:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.iro.umontreal.ca/~pift6266/A06/refs/backprop_old.pdf">&#8220;Learning representations by back-propagating errors.&#8221;</a>
Rumelhart, David E., Geoffrey E. Hinton, and Ronald J. Williams.</li>
<li><a class="reference external" href="http://leon.bottou.org/projects/sgd">&#8220;Stochastic Gradient Descent&#8221;</a> L. Bottou - Website, 2010.</li>
<li><a class="reference external" href="http://ufldl.stanford.edu/wiki/index.php/Backpropagation_Algorithm">&#8220;Backpropagation&#8221;</a>
Andrew Ng, Jiquan Ngiam, Chuan Yu Foo, Yifan Mai, Caroline Suen - Website, 2011.</li>
<li><a class="reference external" href="yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf">&#8220;Efficient BackProp&#8221;</a>
Y. LeCun, L. Bottou, G. Orr, K. Müller - In Neural Networks: Tricks
of the Trade 1998.</li>
<li><a class="reference external" href="http://arxiv.org/pdf/1412.6980v8.pdf">&#8220;Adam: A method for stochastic optimization.&#8221;</a>
Kingma, Diederik, and Jimmy Ba. arXiv preprint arXiv:1412.6980 (2014).</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
        &copy; 2010 - 2014, scikit-learn developers (BSD License).
      <a href="../_sources/modules/neural_networks_supervised.txt" rel="nofollow">Show this page source</a>
    </div>
     <div class="rel">
    
    <div class="buttonPrevious">
      <a href="calibration.html">Previous
      </a>
    </div>
    
     </div>

    
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-22606712-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    

    <script src="http://www.google.com/jsapi" type="text/javascript"></script>
    <script type="text/javascript"> google.load('search', '1',
        {language : 'en'}); google.setOnLoadCallback(function() {
            var customSearchControl = new
            google.search.CustomSearchControl('016639176250731907682:tjtqbvtvij0');
            customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
            var options = new google.search.DrawOptions();
            options.setAutoComplete(true);
            customSearchControl.draw('cse', options); }, true);
    </script>
  </body>
</html>